{
  "openapi": "3.0.3",
  "info": {
    "title": "Agendamento API",
    "version": "1.0.0",
    "description": "API de agendamento - Documentação"
  },
  "servers": [
    {
      "url": "/api",
      "description": "API Server"
    }
  ],
  "components": {
    "securitySchemes": {
      "ApiKeyAuth": {
        "type": "apiKey",
        "in": "header",
        "name": "x-api-key"
      }
    }
  },
  "security": [
    {
      "ApiKeyAuth": []
    }
  ],
  "paths": {
    "/health/live": {
      "get": {
        "tags": ["health"],
        "responses": { "200": { "description": "OK" } }
      }
    },
    "/health/ready": {
      "get": {
        "tags": ["health"],
        "responses": {
          "200": { "description": "OK" },
          "503": { "description": "DB indisponível" }
        }
      }
    },
    "/services": {
      "get": { "tags": ["services"], "responses": { "200": { "description": "Lista serviços" } } },
      "post": { "tags": ["services"], "responses": { "201": { "description": "Cria serviço" } } }
    },
    "/services/{id}": {
      "get": {
        "tags": ["services"],
        "parameters": [{ "name": "id", "in": "path", "required": true, "schema": { "type": "integer" } }],
        "responses": { "200": { "description": "Serviço" }, "404": { "description": "Não encontrado" } }
      },
      "put": {
        "tags": ["services"],
        "parameters": [{ "name": "id", "in": "path", "required": true, "schema": { "type": "integer" } }],
        "responses": { "200": { "description": "Atualiza serviço" } }
      },
      "delete": {
        "tags": ["services"],
        "parameters": [{ "name": "id", "in": "path", "required": true, "schema": { "type": "integer" } }],
        "responses": { "204": { "description": "Remove serviço" } }
      }
    },
    "/business-hours": {
      "get": { "tags": ["business"], "responses": { "200": { "description": "Lista horários" } } },
      "put": { "tags": ["business"], "responses": { "200": { "description": "Atualiza horários" } } }
    },
    "/business-hours/{dayOfWeek}/breaks": {
      "put": {
        "tags": ["business"],
        "parameters": [
          {
            "name": "dayOfWeek",
            "in": "path",
            "required": true,
            "schema": { "type": "integer", "minimum": 0, "maximum": 6 }
          }
        ],
        "responses": { "200": { "description": "Atualiza pausas" }, "404": { "description": "Não configurado" } }
      }
    },
    "/business-days": {
      "get": { "tags": ["business"], "responses": { "200": { "description": "Lista overrides" } } }
    },
    "/business-days/{date}": {
      "put": {
        "tags": ["business"],
        "parameters": [
          {
            "name": "date",
            "in": "path",
            "required": true,
            "schema": { "type": "string", "pattern": "^\\\\d{4}-\\\\d{2}-\\\\d{2}$" }
          }
        ],
        "responses": { "200": { "description": "Upsert override" }, "400": { "description": "Requisição inválida" } }
      },
      "delete": {
        "tags": ["business"],
        "parameters": [
          {
            "name": "date",
            "in": "path",
            "required": true,
            "schema": { "type": "string", "pattern": "^\\\\d{4}-\\\\d{2}-\\\\d{2}$" }
          }
        ],
        "responses": { "204": { "description": "Remove override" }, "404": { "description": "Não encontrado" } }
      }
    },
    "/slots": { "get": { "tags": ["appointments"], "responses": { "200": { "description": "Slots disponíveis" } } } },
    "/appointments": { "post": { "tags": ["appointments"], "responses": { "201": { "description": "Cria agendamento" } } } },
    "/appointments/{id}/cancel": {
      "patch": {
        "tags": ["appointments"],
        "parameters": [{ "name": "id", "in": "path", "required": true, "schema": { "type": "integer" } }],
        "responses": {
          "200": { "description": "Cancela" },
          "404": { "description": "Não encontrado" },
          "409": { "description": "Conflito" }
        }
      }
    }
  }
}
